<html><head><link rel="import" href="../bower_components/app-storage/app-indexeddb-mirror/app-indexeddb-mirror.html">
<link rel="import" href="../bower_components/iron-ajax/iron-ajax.html">

</head><body><dom-module id="base-iron-ajax">

    <template>

        

        
        
        

        
        
        

        

        <iron-ajax id="request" handle-as="json" url="{{url}}" last-response="{{data}}" debounce-duration="300">
        </iron-ajax>
        

        <app-indexeddb-mirror key="albums" data="[[data]]" persisted-data="{{response}}">
        </app-indexeddb-mirror>

    </template>

    <script>Polymer({is:"base-iron-ajax",properties:{response:{notify:!0}},attached:function(){this.auto&&this.generateRequest()},generateRequest:function(e){this.generateToken(e)},generateToken:function(e){$.ajax({context:this,async:!1,type:"GET",url:"http://www.hhadictos.com/external/spotifytoken.php",dataType:"json",error:function(){console.log("Unable to load feed, Incorrect path or invalid feed")},success:function(t){this.$.request.headers={Accept:"application/json",Authorization:"Bearer "+t.access_token},this._cancelCurrentRequest(),this._setRequestParameters(e),this._performSearch()}})},_cancelCurrentRequest:function(){this.$.request.lastRequest&&this.$.request.lastRequest.abort()},_performSearch:function(e){this.$.request.generateRequest()},_setRequestParameters:function(e){this._setUrl(e),this._setParams(e)},_setUrl:function(e){e.url&&(this.$.request.url=e.url)},_setParams:function(e){this.$.request.params=void 0,e.params&&(this.$.request.params=e.params)}});</script>

</dom-module>
</body></html>